!function(){"use strict";function e(e,t){return t||e}function t(t,n){if(null==t)throw new Error(e(`Assertion failed: Input ${t} does not exist`,n))}function n(t,n){if(!t)throw new Error(e(`Assertion failed: Input ${t} is not truthy`,n))}const o=[{content:"Peak Taekwondo will not have classes on Thursday, 25 November 2021 in observance of Thanksgiving.",creationDate:1637087097034,endDate:163791e7}],s=["January","February","March","April","May","June","July","August","September","October","November","December"];function c(e){const t=new Date(e);return`${t.getDate()} ${s[t.getMonth()]} ${t.getFullYear()}`}class i{constructor(e){this.tableContainer=e;const n=e.querySelector("table");t(n,`Unable to locate expected announcment table for ${e.id}`);let o=n.querySelector("tbody");o||(o=n),this.tableBody=o}addAnnouncement(e){const t=document.createElement("tr"),n=document.createElement("td");n.classList.add("issue-date"),n.innerText=c(e.creationDate);const o=document.createElement("td");o.classList.add("announcement"),o.innerText=e.content,t.appendChild(n),t.appendChild(o),this.tableBody.appendChild(t),this.tableContainer.classList.remove("empty")}}function a(e){let t=0;const n=e.content;for(let e=0;e<n.length;e++)t=(t<<5)-t+n.charCodeAt(e),t|=0;return`peak.announcement.ids.${e.creationDate}-${t}-${e.endDate}`}const r=/peak\.announcment\.ids\.\d+-\d+-\d+/;function l(e){n(r.test(e),`${e} does not appear to be an Announcment ID`);const t=e.split("-").pop(),o=Number.parseInt(t);return new Date(o)}const d=new Map;function u(e){return d.has(e)||d.set(e,new e),d.get(e)}function m(e=0){return new Promise(t=>{setTimeout(t,e)})}var h=function(e,t,n,o){return new(n||(n=Promise))((function(s,c){function i(e){try{r(o.next(e))}catch(e){c(e)}}function a(e){try{r(o.throw(e))}catch(e){c(e)}}function r(e){e.done?s(e.value):function t(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(i,a)}r((o=o.apply(e,t||[])).next())}))};class p{constructor(e){this.announcement=e,this.element=document.createElement("div"),this.element.classList.add("butter-bar"),this.element.classList.add("card");const t=document.createElement("div");t.classList.add("message"),t.innerHTML=`<b>${c(e.creationDate)}:</b> ${e.content}`;const n=document.createElement("div");n.classList.add("close"),n.tabIndex=-1;const o=document.createElement("img");o.src="resources/close-icon.png",n.appendChild(o),this.element.appendChild(t),this.element.appendChild(n),this.closeElement=n,document.body.appendChild(this.element)}show(){return h(this,void 0,void 0,(function*(){const e=document.documentElement.clientHeight;this.element.style.top=`${e}px`,yield m(0),this.element.classList.add("animate"),yield m(0),this.element.style.top=`${e-20-this.element.clientHeight}px`}))}addOnClose(e){this.closeElement.onclick=e}close(){document.body.removeChild(this.element),window.localStorage.setItem(a(this.announcement),"viewed")}}class f{constructor(){if(this.announcements=[],"undefined"!=typeof Storage){const e=[],t=new Date,n=window.localStorage;for(let o=0;o<n.length;o++){const s=n.key(o);r.test(s)&&l(s)<t&&e.push(s)}for(const t of e)n.remove(t)}}manageAnnouncement(e){if("undefined"==typeof Storage)return;if("viewed"===window.localStorage.getItem(a(e)))return;const t=new p(e);t.addOnClose(()=>{this.closeCurrent()}),this.announcements.push(t),m(0).then(()=>{this.updateDisplay()})}closeCurrent(){this.showing&&(this.showing.close(),this.showing=void 0),m(0).then(()=>{this.updateDisplay()})}updateDisplay(){this.showing||(this.showing=this.announcements.pop(),this.showing&&this.showing.show())}static getInstance(){return u(f)}}function w(e,t){return t.creationDate-e.creationDate}function g(e,t){const n=document.getElementById(e);if(n){const e=new i(n);for(const n of t)e.addAnnouncement(n)}}class y{constructor(){}load(){const e=Date.now(),t=[],n=[];for(const s of o)s.endDate<e?n.push(s):(!s.startDate||s.startDate<=e)&&t.push(s);t.sort(w),n.sort(w),g("live",t),g("expired",n);for(const e of t)f.getInstance().manageAnnouncement(e)}static getInstance(){return u(y)}}!function D(e,o){n(e,"Symbol name must not be empty."),t(o,"Symbol must be defined.");let s=window;const c=e.split(".");for(const e of c.slice(0,-1))s[e]||(s[e]={}),s=s[e];const i=c.pop();n(!s[i],`Symbol ${e} already defined`),s[i]=o}("peak.loadAnnouncements",(function b(){y.getInstance().load()}))}();
//# sourceMappingURL=peak_compiled.js.map