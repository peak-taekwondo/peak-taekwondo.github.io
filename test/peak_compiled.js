!function(){"use strict";function e(e,t){if(!e)throw new Error(function n(e,t){return t?`${e} -- ${t}`:e}(`Assertion failed: ${e} is not truthy`,t))}const t=[{startDate:new Date(2021,7,10).getTime(),endDate:new Date(2021,8,10).getTime(),creationDate:new Date(2021,6,18).getTime(),content:"This is an announcement that is not yet valid"},{endDate:new Date(2021,10,10).getTime(),creationDate:new Date(2021,5,10).getTime(),content:"This is an announcement that has no start date"},{startDate:new Date(2021,6,10).getTime(),endDate:new Date(2021,7,10).getTime(),creationDate:new Date(2021,6,18).getTime(),content:"This is an announcement that is in the middle of being valid"},{startDate:new Date(2020,6,10).getTime(),endDate:new Date(2020,7,10).getTime(),creationDate:new Date(2020,5,10).getTime(),content:"This is an announcement that is past valid"}],n=["January","February","March","April","May","June","July","August","September","October","November","December"];function o(e){const t=new Date(e);return`${t.getDate()} ${n[t.getMonth()]} ${t.getFullYear()}`}class a{constructor(t){this.tableContainer=t;const n=t.querySelector("table");e(n,`Unable to locate expected announcment table for ${t.id}`);let o=n.querySelector("tbody");o||(o=n),this.tableBody=o}addAnnouncement(e){const t=document.createElement("tr"),n=document.createElement("td");n.classList.add("issue-date"),n.innerText=o(e.creationDate);const a=document.createElement("td");a.classList.add("announcement"),a.innerText=e.content,t.appendChild(n),t.appendChild(a),this.tableBody.appendChild(t),this.tableContainer.classList.remove("empty")}}function s(e){let t=0;const n=e.content;for(let e=0;e<n.length;e++)t=(t<<5)-t+n.charCodeAt(e),t|=0;return`peak.announcement.ids.${e.creationDate}-${t}`}const i=new Map;function c(e){return i.has(e)||i.set(e,new e),i.get(e)}function r(e=0){return new Promise(t=>{setTimeout(t,e)})}var l=function(e,t,n,o){return new(n||(n=Promise))((function(a,s){function i(e){try{r(o.next(e))}catch(e){s(e)}}function c(e){try{r(o.throw(e))}catch(e){s(e)}}function r(e){e.done?a(e.value):function t(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(i,c)}r((o=o.apply(e,t||[])).next())}))};class d{constructor(e){this.announcement=e,this.element=document.createElement("div"),this.element.classList.add("butter-bar"),this.element.classList.add("card");const t=document.createElement("div");t.classList.add("message"),t.innerHTML=`<b>${o(e.creationDate)}:</b> ${e.content}`;const n=document.createElement("div");n.classList.add("close"),n.tabIndex=-1;const a=document.createElement("img");a.src="resources/close-icon.png",n.appendChild(a),this.element.appendChild(t),this.element.appendChild(n),this.closeElement=n,document.body.appendChild(this.element)}show(){return l(this,void 0,void 0,(function*(){const e=document.querySelector("html").clientHeight;this.element.style.top=`${e}px`,yield r(0),this.element.classList.add("animate"),yield r(0),this.element.style.top=`${e-20-this.element.clientHeight}px`}))}addOnClose(e){this.closeElement.onclick=e}close(){document.body.removeChild(this.element),window.localStorage.setItem(s(this.announcement),"viewed")}}class u{constructor(){this.announcements=[]}manageAnnouncement(e){if("undefined"==typeof Storage)return;if("viewed"===window.localStorage.getItem(s(e)))return;const t=new d(e);t.addOnClose(()=>{this.closeCurrent()}),this.announcements.push(t),r(0).then(()=>{this.updateDisplay()})}closeCurrent(){this.showing&&(this.showing.close(),this.showing=void 0),r(0).then(()=>{this.updateDisplay()})}updateDisplay(){this.showing||(this.showing=this.announcements.pop(),this.showing&&this.showing.show())}static getInstance(){return c(u)}}function m(e,t){return t.creationDate-e.creationDate}function h(e,t){const n=document.getElementById(e);if(n){const e=new a(n);for(const n of t)e.addAnnouncement(n)}}class p{constructor(){}load(){const e=Date.now(),n=[],o=[];for(const a of t)a.endDate<e?o.push(a):(!a.startDate||a.startDate<=e)&&n.push(a);n.sort(m),o.sort(m),h("live",n),h("expired",o);for(const e of n)u.getInstance().manageAnnouncement(e)}static getInstance(){return c(p)}}!function f(t,n){e(t,"Symbol name must not be empty."),e(n,"Symbol must be defined.");let o=window;const a=t.split(".");for(const e of a.slice(0,-1))o[e]||(o[e]={}),o=o[e];const s=a.pop();e(!o[s],`Symbol ${t} already defined`),o[s]=n}("peak.loadAnnouncements",(function g(){p.getInstance().load()}))}();
//# sourceMappingURL=peak_compiled.js.map